var R=(E,D,c)=>new Promise((v,d)=>{var p=t=>{try{l(c.next(t))}catch(_){d(_)}},m=t=>{try{l(c.throw(t))}catch(_){d(_)}},l=t=>t.done?v(t.value):Promise.resolve(t.value).then(p,m);l((c=c.apply(E,D)).next())});import{$ as U,f as k,y as H,A as $,Y as f,a4 as q,aG as Y,aH as G,_ as J,Z as M,k as W,o as g,n as L,g as a,w as s,b as B,h as F,aI as K,j as Q,Q as Z,aa as S,a0 as z,N as X,O as ee,p as h,t as te,i as ue}from"./vendor.303085b1.js";import{_ as oe}from"./CopyText.9e361d69.js";import{U as T,B as C,R as P,m as b,j,A as x,u as ae,C as se,n as le,l as ne}from"./index.0cdc481d.js";/* empty css              *//* empty css                  *//* empty css               *//* empty css                */const re=()=>U(T.APP.ALAPI,{baseURL:C,method:P.POST,headers:b(),body:j({path:x.FETCH_URL_TYPES,params:""})}),ie=E=>U(T.APP.ALAPI,{baseURL:C,method:P.POST,headers:b(),body:j({path:x.URL_SHORTENER,params:JSON.stringify(E)})}),ce={class:"flex flex-row justify-end mt-8"},de=ue(" \u751F\u6210\u77ED\u7F51\u5740 "),pe=h("div",{class:"list-document"},[h("p",null,"\u4E0D\u9009\u62E9\u77ED\u7F51\u5740\u524D\u7F00\u5219\u968F\u673A\u751F\u6210"),h("p",null,"\u4E0D\u4E00\u5B9A\u5B8C\u5168\u6309\u7167\u6240\u9009\u7684\u524D\u7F00\u751F\u6210\u77ED\u7F51\u5740")],-1),ge=k({setup(E){const{t:D}=H(),{useJsonStorage:c}=le();ae().setTitle("\u77ED\u7F51\u5740\u751F\u6210"),$({title:`\u77ED\u7F51\u5740\u751F\u6210 - ${D("app_name")}`});const v=f(!0),d=f(!1),p=f(""),m=c(se.APP_URL_SHORTENER_URL_TYPES,null),l=f(),t=f({type:"",url:""}),_={type:[{required:!1}],url:[{required:!0,message:"\u8BF7\u8F93\u5165\u77ED\u7F51\u5740"},{validator(o,e,u){e.startsWith("http")||e.startsWith("https")?u():u(new Error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u7F51\u5740"))}}]},V=()=>R(this,null,function*(){try{const{code:o,data:e,message:u,retCode:n}=yield re();if(o!==200||n!==0)throw new Error(u);(e==null?void 0:e.length)>0&&(m.value=e)}catch(o){S.error(o.message)}finally{v.value=!1}}),I=()=>R(this,null,function*(){var o,e;try{if(!(yield(o=l==null?void 0:l.value)==null?void 0:o.validate()))return}catch(u){return}try{d.value=!0;const{code:u,data:n,message:y,retCode:w}=yield ie(t.value);if(u!==200||w!==0)throw new Error(y);if(((e=n==null?void 0:n.short_url)==null?void 0:e.length)>0)p.value=n.short_url;else throw new Error("\u77ED\u7F51\u5740\u751F\u6210\u5931\u8D25")}catch(u){S.error(u.message)}finally{d.value=!1}});return q(()=>{V()}),(o,e)=>{const u=Y,n=G,y=J,w=M,N=W,A=ne,O=oe;return g(),L("div",null,[a(A,{class:"container-content-section"},{default:s(()=>[a(F(z),{ref:(r,i)=>{i.urlForm=r,l.value=r},model:t.value,rules:_,"label-position":"top"},{default:s(()=>[a(y,{prop:"type",label:"\u77ED\u7F51\u5740\u524D\u7F00"},{default:s(()=>{var r;return[a(n,{modelValue:t.value.type,"onUpdate:modelValue":e[0]||(e[0]=i=>t.value.type=i),loading:v.value&&!((r=F(m))==null?void 0:r.length),placeholder:"\u8BF7\u9009\u62E9\u77ED\u7F51\u5740\u524D\u7F00 (\u6216\u968F\u673A)",class:"w-full"},{default:s(()=>[(g(!0),L(X,null,ee(F(m),i=>(g(),B(u,{key:i.type,label:i.domain,value:i.type},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]}),_:1}),a(y,{prop:"url",label:"\u5F85\u7F29\u77ED\u7F51\u5740"},{default:s(()=>[a(w,{modelValue:t.value.url,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value.url=r),placeholder:"\u8BF7\u8F93\u5165\u7F51\u5740"},null,8,["modelValue"])]),_:1}),h("div",ce,[a(N,{type:"primary",onClick:I,loading:d.value},{default:s(()=>[de]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1}),p.value.length?(g(),B(A,{key:0,title:"\u751F\u6210\u7ED3\u679C",icon:F(K),class:"container-content-section with-title"},{default:s(()=>[a(O,{text:p.value},{default:s(()=>[h("div",null,te(p.value),1)]),_:1},8,["text"])]),_:1},8,["icon"])):Q("",!0),a(A,{title:o.$t("title.document"),icon:F(Z),class:"container-content-section with-title"},{default:s(()=>[pe]),_:1},8,["title","icon"])])}}});export{ge as default};
