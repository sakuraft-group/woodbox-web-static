var R=(E,D,c)=>new Promise((v,p)=>{var d=t=>{try{l(c.next(t))}catch(_){p(_)}},m=t=>{try{l(c.throw(t))}catch(_){p(_)}},l=t=>t.done?v(t.value):Promise.resolve(t.value).then(d,m);l((c=c.apply(E,D)).next())});import{$ as U,f as k,y as H,A as $,Y as f,a4 as q,aG as Y,aH as G,_ as J,Z as M,k as W,o as g,n as L,g as o,w as s,b as B,h as F,aI as K,j as Q,Q as Z,aa as S,a0 as z,N as X,O as ee,p as h,t as te,i as ue}from"./vendor.0a64e0b0.js";import{_ as ae}from"./CopyText.41ab5170.js";import{U as T,B as b,R as C,m as P,j as x,A as V,u as oe,C as se,n as le,l as ne}from"./index.427ef12b.js";/* empty css              *//* empty css                  *//* empty css               */const re=()=>U(T.APP.ALAPI,{baseURL:b,method:C.POST,headers:P(),body:x({path:V.FETCH_URL_TYPES,params:""})}),ie=E=>U(T.APP.ALAPI,{baseURL:b,method:C.POST,headers:P(),body:x({path:V.URL_SHORTENER,params:JSON.stringify(E)})}),ce={class:"flex flex-row justify-end mt-8"},pe=ue(" \u751F\u6210\u77ED\u7F51\u5740 "),de=h("div",{class:"list-document"},[h("p",null,"\u4E0D\u9009\u62E9\u77ED\u7F51\u5740\u524D\u7F00\u5219\u968F\u673A\u751F\u6210"),h("p",null,"\u4E0D\u4E00\u5B9A\u5B8C\u5168\u6309\u7167\u6240\u9009\u7684\u524D\u7F00\u751F\u6210\u77ED\u7F51\u5740")],-1),ye=k({setup(E){const{t:D}=H(),{useJsonStorage:c}=le();oe().setTitle("\u77ED\u7F51\u5740\u751F\u6210"),$({title:`\u77ED\u7F51\u5740\u751F\u6210 - ${D("app_name")}`});const v=f(!0),p=f(!1),d=f(""),m=c(se.APP_URL_SHORTENER_URL_TYPES,null),l=f(),t=f({type:"",url:""}),_={type:[{required:!1}],url:[{required:!0,message:"\u8BF7\u8F93\u5165\u77ED\u7F51\u5740"},{validator(a,e,u){e.startsWith("http")||e.startsWith("https")?u():u(new Error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u7F51\u5740"))}}]},j=()=>R(this,null,function*(){try{const{code:a,data:e,message:u,retCode:n}=yield re();if(a!==200||n!==0)throw new Error(u);(e==null?void 0:e.length)>0&&(m.value=e)}catch(a){S.error(a.message)}finally{v.value=!1}}),I=()=>R(this,null,function*(){var a,e;try{if(!(yield(a=l==null?void 0:l.value)==null?void 0:a.validate()))return}catch(u){return}try{p.value=!0;const{code:u,data:n,message:y,retCode:w}=yield ie(t.value);if(u!==200||w!==0)throw new Error(y);if(((e=n==null?void 0:n.short_url)==null?void 0:e.length)>0)d.value=n.short_url;else throw new Error("\u77ED\u7F51\u5740\u751F\u6210\u5931\u8D25")}catch(u){S.error(u.message)}finally{p.value=!1}});return q(()=>{j()}),(a,e)=>{const u=Y,n=G,y=J,w=M,N=W,A=ne,O=ae;return g(),L("div",null,[o(A,{class:"container-content-section"},{default:s(()=>[o(F(z),{ref:(r,i)=>{i.urlForm=r,l.value=r},model:t.value,rules:_,"label-position":"top"},{default:s(()=>[o(y,{prop:"type",label:"\u77ED\u7F51\u5740\u524D\u7F00"},{default:s(()=>{var r;return[o(n,{modelValue:t.value.type,"onUpdate:modelValue":e[0]||(e[0]=i=>t.value.type=i),loading:v.value&&!((r=F(m))==null?void 0:r.length),placeholder:"\u8BF7\u9009\u62E9\u77ED\u7F51\u5740\u524D\u7F00 (\u6216\u968F\u673A)",class:"w-full"},{default:s(()=>[(g(!0),L(X,null,ee(F(m),i=>(g(),B(u,{key:i.type,label:i.domain,value:i.type},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]}),_:1}),o(y,{prop:"url",label:"\u5F85\u7F29\u77ED\u7F51\u5740"},{default:s(()=>[o(w,{modelValue:t.value.url,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value.url=r),placeholder:"\u8BF7\u8F93\u5165\u7F51\u5740"},null,8,["modelValue"])]),_:1}),h("div",ce,[o(N,{type:"primary",onClick:I,loading:p.value},{default:s(()=>[pe]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1}),d.value.length?(g(),B(A,{key:0,title:"\u751F\u6210\u7ED3\u679C",icon:F(K),class:"container-content-section with-title"},{default:s(()=>[o(O,{text:d.value},{default:s(()=>[h("div",null,te(d.value),1)]),_:1},8,["text"])]),_:1},8,["icon"])):Q("",!0),o(A,{title:a.$t("title.document"),icon:F(Z),class:"container-content-section with-title"},{default:s(()=>[de]),_:1},8,["title","icon"])])}}});export{ye as default};
