var h=(B,E,d)=>new Promise((v,C)=>{var A=i=>{try{p(d.next(i))}catch(l){C(l)}},V=i=>{try{p(d.throw(i))}catch(l){C(l)}},p=i=>i.done?v(i.value):Promise.resolve(i.value).then(A,V);p((d=d.apply(B,E)).next())});import{an as q,r as H,o as x,n as y,g as u,K as M,w as a,p as r,i as j,f as O,y as z,x as G,A as K,Y as f,m as Y,Z,k as J,_ as Q,L as W,t as $,h as X,a0 as ee,E as _}from"./vendor.0a64e0b0.js";import{_ as ue,a as te,u as se,b as oe,c as ae,s as re,k as le}from"./index.98f0f520.js";/* empty css                  */import{C as g,a as ne,_ as ce}from"./contact.5c8dfd8f.js";/* empty css              */import{u as ie}from"./useValidator.9a78a0bb.js";const de={},me={class:"flex flex-row justify-start items-center text-xs text-gray-500"},fe=r("span",{class:"ml-2 mr-2px"},"\u5DF2\u9605\u8BFB\u5E76\u540C\u610F",-1),pe=j("\u9690\u79C1\u6761\u6B3E"),_e=r("span",{class:"ml-2px mr-2px"},"\u548C",-1),ve=j("\u670D\u52A1\u6761\u6B3E");function Ce(B,E){const d=q,v=H("router-link");return x(),y("div",me,[u(d,M({size:"small"},B.$attrs),null,16),fe,u(v,{to:"/privacy",target:"_blank"},{default:a(()=>[pe]),_:1}),_e,u(v,{to:"/terms",target:"_blank"},{default:a(()=>[ve]),_:1})])}var Be=ue(de,[["render",Ce]]);const Ee={class:"container-content-section"},Fe=r("span",{class:"text-xl text-gray-700"},"\u6CE8\u518C\u8D26\u53F7",-1),we={key:0,class:"flex flex-col justify-start items-center mt-8"},he={class:"mt-12 w-full"},xe=r("span",null,"\u5F00\u59CB\u6CE8\u518C",-1),ye={key:1,class:"flex flex-col justify-start items-center"},ge={class:"flex flex-col justify-start items-center text-sm text-gray-500"},Ae={class:"mt-8"},Ve={class:"mt-8 w-full"},De=r("span",{class:"text-sm text-gray-500"}," \u5BC6\u7801\u4E3A 6~16 \u4F4D\uFF0C\u53EF\u5305\u542B\u6570\u5B57\u3001\u5927\u5C0F\u5199\u82F1\u6587\u5B57\u6BCD\u548C\u7B26\u53F7\u7EC4\u6210\uFF0C\u4E0D\u80FD\u4E3A\u7EAF\u82F1\u6587\u6216\u7EAF\u6570\u5B57 ",-1),ke=r("span",null,"\u6CE8\u518C\u8D26\u53F7",-1),Pe={class:"mt-4"},Ne=O({setup(B){const{t:E}=z(),d=G(),v=te(),{validatePhoneNumber:C,validateEmail:A,validatePassword:V}=ie();se().setTitle("\u6CE8\u518C\u8D26\u53F7"),K({title:`\u6CE8\u518C\u8D26\u53F7 - ${E("app_name")}`,script:oe()});const p=f(!1),i=f(!1),l=f(!1),k=f(!0),s=f(""),n=f({verifyCode:"",password:"",confirmPassword:""}),b={verifyCode:{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",length:4},password:[{required:!0,trigger:"blur",validator:(c,e,t)=>{e.trim()===""?t(new Error("\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801")):V(e)?t():t(new Error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u5BC6\u7801"))}}],confirmPassword:[{required:!0,trigger:"blur",validator:(c,e,t)=>{e.trim()===""?t(new Error("\u8BF7\u786E\u8BA4\u65B0\u5BC6\u7801")):n.value.password!==e?t(new Error("\u4E0E\u65B0\u5BC6\u7801\u4E0D\u4E00\u81F4")):t()}}]},P=f(),D=f(!1);function S(){return h(this,null,function*(){if(!A(s.value)&&!C(s.value)){_.error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u6216\u624B\u673A\u53F7");return}p.value=!0;const c=yield v.checkExists(s.value);if(p.value=!1,k.value=c[0]){_.error("\u8BE5\u8D26\u6237\u5DF2\u5B58\u5728");return}l.value=C(s.value)})}function T(){return h(this,null,function*(){try{const[c,e]=yield ae();if(!c)throw new Error(e);const{code:t,message:m,retCode:F}=yield re({channel:l.value?g.PHONE:g.EMAIL,codeType:ne.REGISTER,target:s.value,challenge:e});if(t!==200||F!==0)throw new Error(m);return _.success("\u9A8C\u8BC1\u7801\u53D1\u9001\u6210\u529F, 5 \u5206\u949F\u5185\u6709\u6548"),!0}catch(c){return _.error(`${c}`),!1}})}function R(){return h(this,null,function*(){var c;if(!!(yield(c=P.value)==null?void 0:c.validate())){if(!D.value){_.error("\u8BF7\u5148\u9605\u8BFB\u5E76\u540C\u610F\u300A\u9690\u79C1\u6761\u6B3E\u300B\u548C\u300A\u670D\u52A1\u6761\u6B3E\u300B");return}try{const{code:e,message:t,retCode:m}=yield le({channel:l.value?g.PHONE:g.EMAIL,username:"",phone:l.value?s.value:"",email:l.value?"":s.value,verifyCode:n.value.verifyCode,password:n.value.password,confirmPassword:n.value.confirmPassword});if(e!==200||m!==0)throw new Error(t);_.success("\u8D26\u53F7\u6CE8\u518C\u6210\u529F"),d.replace({path:"/account/login"})}catch(e){_.error(`${e.message}`)}}})}return(c,e)=>{const t=Y,m=Z,F=J,I=ce,w=Q,N=Be,L=W;return x(),y("div",Ee,[u(L,{class:"pt-2 p-4 w-full max-w-360px m-auto flex flex-col justify-start"},{default:a(()=>[u(t,{justify:"center",align:"middle"},{default:a(()=>[Fe]),_:1}),k.value?(x(),y("div",we,[u(m,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value=o),placeholder:"\u90AE\u7BB1/\u624B\u673A\u53F7",autocomplete:"off"},null,8,["modelValue"]),r("div",he,[u(F,{type:"primary",class:"w-full",loading:p.value,onClick:S},{default:a(()=>[xe]),_:1},8,["loading"])])])):(x(),y("div",ye,[r("div",ge,[r("span",Ae," \u8BF7\u70B9\u51FB\u53D1\u9001\u9A8C\u8BC1\u7801\u81F3 "+$(l.value?s.value.replaceRange(3,8,"****"):s.value.replaceRange(0,s.value.indexOf("@"),"****")),1),r("span",null," \u82E5\u672A\u63A5\u6536\u5230\uFF0C\u8BF7\u68C0\u67E5"+$(l.value?"\u624B\u673A\u53F7":"\u90AE\u7BB1")+"\u662F\u5426\u586B\u5199\u6B63\u786E ",1)]),r("div",Ve,[u(X(ee),{ref:(o,U)=>{U.registerForm=o,P.value=o},model:n.value,rules:b},{default:a(()=>[u(w,{prop:"verifyCode"},{default:a(()=>[u(m,{modelValue:n.value.verifyCode,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.verifyCode=o),placeholder:"\u5B89\u5168\u9A8C\u8BC1\u7801",autocomplete:"off"},{append:a(()=>[u(I,{onSend:T})]),_:1},8,["modelValue"])]),_:1}),u(w,{prop:"password"},{default:a(()=>[u(m,{type:"passowrd","show-password":"",modelValue:n.value.password,"onUpdate:modelValue":e[2]||(e[2]=o=>n.value.password=o),placeholder:"\u65B0\u5BC6\u7801",autocomplete:"off"},null,8,["modelValue"])]),_:1}),u(w,{prop:"confirmPassword"},{default:a(()=>[u(m,{type:"passowrd","show-password":"",modelValue:n.value.confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=o=>n.value.confirmPassword=o),placeholder:"\u786E\u8BA4\u65B0\u5BC6\u7801",autocomplete:"off"},null,8,["modelValue"])]),_:1}),De,u(w,{class:"mt-12"},{default:a(()=>[u(F,{type:"primary",class:"w-full",loading:i.value,onClick:R},{default:a(()=>[ke]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])),r("div",Pe,[u(N,{modelValue:D.value,"onUpdate:modelValue":e[4]||(e[4]=o=>D.value=o)},null,8,["modelValue"])])]),_:1})])}}});export{Ne as default};
